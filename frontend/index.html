<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MLX Studio</title>
    <meta name="description" content="High-performance MLX inference server with KV caching">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <!-- Highlight.js core -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <!-- Marked.js for markdown parsing -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/12.0.1/marked.min.js"></script>
    <link rel="stylesheet" href="styles/theme.css">
    <link rel="stylesheet" href="styles/components.css">
    <link rel="stylesheet" href="styles/settings-modal.css">
    <link rel="stylesheet" href="styles/voice-mode.css">
    <style>
        /* Custom syntax highlighting that works in both themes */
        .hljs {
            background: transparent !important;
            color: var(--fg-0);
        }
        .hljs-keyword,
        .hljs-selector-tag,
        .hljs-built_in,
        .hljs-name,
        .hljs-tag { color: var(--hljs-keyword, #ff7b72); }
        .hljs-string,
        .hljs-title,
        .hljs-section,
        .hljs-attribute,
        .hljs-literal,
        .hljs-template-tag,
        .hljs-template-variable,
        .hljs-type,
        .hljs-addition { color: var(--hljs-string, #a5d6ff); }
        .hljs-comment,
        .hljs-quote,
        .hljs-deletion,
        .hljs-meta { color: var(--hljs-comment, #8b949e); }
        .hljs-number,
        .hljs-regexp,
        .hljs-selector-id,
        .hljs-selector-class { color: var(--hljs-number, #79c0ff); }
        .hljs-variable,
        .hljs-template-variable,
        .hljs-attr { color: var(--hljs-variable, #ffa657); }
        .hljs-function,
        .hljs-title.function_ { color: var(--hljs-function, #d2a8ff); }
        .hljs-params { color: var(--fg-0); }
        .hljs-class .hljs-title { color: var(--hljs-class, #ffa657); }
        .hljs-symbol,
        .hljs-bullet { color: var(--hljs-symbol, #f85149); }

        /* Dark theme (default) */
        :root {
            --hljs-keyword: #ff7b72;
            --hljs-string: #a5d6ff;
            --hljs-comment: #8b949e;
            --hljs-number: #79c0ff;
            --hljs-variable: #ffa657;
            --hljs-function: #d2a8ff;
            --hljs-class: #ffa657;
            --hljs-symbol: #f85149;
        }

        /* Light theme colors */
        [data-theme="light"] {
            --hljs-keyword: #cf222e;
            --hljs-string: #0a3069;
            --hljs-comment: #6e7781;
            --hljs-number: #0550ae;
            --hljs-variable: #953800;
            --hljs-function: #8250df;
            --hljs-class: #953800;
            --hljs-symbol: #cf222e;
        }

        @media (prefers-color-scheme: light) {
            :root:not([data-theme="dark"]) {
                --hljs-keyword: #cf222e;
                --hljs-string: #0a3069;
                --hljs-comment: #6e7781;
                --hljs-number: #0550ae;
                --hljs-variable: #953800;
                --hljs-function: #8250df;
                --hljs-class: #953800;
                --hljs-symbol: #cf222e;
            }
        }
    </style>
</head>
<body>
    <div id="app"></div>

    <!-- Preact + HTM via CDN (no build step needed) -->
    <script type="module">
        import { h, render } from 'https://esm.sh/preact@10.19.3';
        import { useState, useEffect, useRef, useCallback } from 'https://esm.sh/preact@10.19.3/hooks';
        import htm from 'https://esm.sh/htm@3.1.1';

        // Bind htm to Preact's h
        const html = htm.bind(h);

        // Make available globally for components
        window.preact = { h, render, html, useState, useEffect, useRef, useCallback };

        // Import and render app
        import('./app.js').then(({ App }) => {
            render(html`<${App} />`, document.getElementById('app'));
        });
    </script>
</body>
</html>
